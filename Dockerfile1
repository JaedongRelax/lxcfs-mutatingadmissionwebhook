FROM golang:1.10

ENV CGO_ENABLED=0
ENV GOOS=linux
ENV http_proxy=http://10.213.2.253:1087
ENV https_proxy=http://10.213.2.253:1087
RUN go get -u github.com/golang/dep/cmd/dep
COPY ./ /go/src/github.com/lxcfs-webhook
WORKDIR /go/src/github.com/lxcfs-webhook
RUN dep ensure -v
RUN go build -a -installsuffix cgo -o lxcfs-webhook && cp lxcfs-webhook /lxcfs-webhook

ENTRYPOINT ["./lxcfs-webhook"]
